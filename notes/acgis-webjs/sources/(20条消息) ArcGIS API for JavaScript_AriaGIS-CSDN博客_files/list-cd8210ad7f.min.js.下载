$(function(){function t(t){var o=t.data("type"),n=t.parents(".article-item-box").data("articleid");switch(o){case"noTop":comPrompt.show("你确定要取消置顶这篇文章吗？","确定",a,n);break;case"top":comPrompt.show("确定要置顶当前文章？","确定",e,n);break;case"delete":comPrompt.show("确定要删除当前文章？","确定",i,n)}}function e(t){var e={articleId:t};$.ajax({url:blogUrl+"phoenix/web/v1/articleListApi/top",type:"post",dataType:"json",data:e,xhrFields:{withCredentials:!0},success:function(t){t.code?comPrompt.show("文章已置顶！","确定",n,void 0,!1):showToast({text:t.data,bottom:"10%",zindex:9e3,speed:500,time:1500})}})}function a(t){var e={articleId:t};$.ajax({url:blogUrl+"phoenix/web/v1/articleListApi/untop",type:"post",dataType:"json",data:e,xhrFields:{withCredentials:!0},success:function(t){t.code?comPrompt.show("文章已取消置顶！","确定",n,void 0,!1):showToast({text:t.data,bottom:"10%",zindex:9e3,speed:500,time:1500})}})}function i(t){var e={articleId:t};$.ajax({url:blogUrl+"phoenix/web/v1/articleListApi/del",type:"post",dataType:"json",data:e,xhrFields:{withCredentials:!0},success:function(t){t.code?comPrompt.show("文章已删除！","确定",n,void 0,!1):showToast({text:t.data,bottom:"10%",zindex:9e3,speed:500,time:1500})}})}if(listTotal>0){var o=new Paging;o.init({target:"#pageBox",pagesize:pageSize,count:listTotal,current:currentPage,firstTpl:"",lastTpl:"",callback:function(t,e,a){var i=getAllUrl(t);location.href=i}}),$(".article-list").find("button.btn-opt").click(function(){t($(this))});var n=function(){location.reload()}}}),function(){var t={fn:"",data:0,show:function(t,i,o,n,l){this.fn=o,this.data=n,l=void 0===l,$(".promptBox .text").html(t),$(".promptBox .clickYes").html(i),$(".mask").fadeIn(300),$(".promptBox").fadeIn(300),$(document).on("click",".clickYes",e),l?($(".clickNo").show(),$(document).on("click",".clickNo",a)):$(".clickNo").hide()},hide:function(){this.fn="",this.can=0,$(".mask").fadeOut(300),$(".promptBox").fadeOut(300),$(".clickYes").unbind("click",e),$(".clickNo").unbind("click",a)}};$(document).on("click",".Boxclose",function(){$(".mask").fadeOut(300),$(".promptBox").fadeOut(300)});var e=function(){t.fn&&t.fn(t.data),t.hide()},a=function(){t.hide()};window.comPrompt=t}(),$(function(){function t(){var t=this;this.keys=[37,38,39,40],this.preventDefault=function(t){t=t||window.event,t.preventDefault&&t.preventDefault()},this.keydown=function(e){for(var a=t.keys.length;a--;)if(e.keyCode===t.keys[a])return void this.preventDefault(e)},this.wheel=function(e){t.preventDefault(e)},this.disable_scroll=function(){window.addEventListener&&window.addEventListener("DOMMouseScroll",this.wheel,{passive:!1}),window.addEventListener("mousewheel",this.wheel,{passive:!1}),document.addEventListener("mousewheel",this.wheel,{passive:!1}),document.addEventListener("keydown",this.keydown,{passive:!1})},this.enable_scroll=function(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",this.wheel,!1),window.onmousewheel=document.onmousewheel=document.onkeydown=null}}function e(t){$(".newcomer-guide-content .btn").css(a(t.top,t.left)),$(".newcomer-guide-content .text").css(a(t.top-65,t.left-($(".newcomer-guide-content .text").width()-$(".newcomer-guide-content .btn").width())/2)),$(".newcomer-guide-content .close-box").css(a(t.top-100,t.left+320)),$(".newcomer-guide-content .hand").css(a(20,200))}function a(t,e){return{position:"absolute",top:t,left:e}}function i(){return $(".no-data .btn-write-blog").offset()}function o(){return!!localStorage.getItem(currentUserName+"listpage_newcomer_guide")}function n(){localStorage.setItem(currentUserName+"listpage_newcomer_guide",!0)}function l(){$(document).on("click",".newcomer-guide, newcomer-guide .close-box",function(t){n(),$(this).hide(),b.enable_scroll()}).on("click",".btn",function(t){n()})}function s(){$(".container-header-ul-li").each(function(t,e){0==x&&0!=$(e).data("num")&&0==$("#container-header-blog").data("num")&&($(e).addClass("active").siblings().removeClass("active"),$(".articleMeList-integration").eq(t+1).show().siblings(".articleMeList-integration").hide(),x+=1)}),0==x&&($("#articleMeList-blog").show(),w()),!isOwner&&$(".container-header-ul-li span").length<=0?$("#container-header-ul").hide():$("#container-header-ul").show()}function c(t){switch(t){case"collecAdd":A=blogUrl+"/phoenix/web/v1/collect-folder/created-list";break;case"collecFan":A=blogUrl+"/phoenix/web/v1/collect-folder/follow-list";break;case"FollowNum":A=blogUrl+"/phoenix/web/v1/follow/list";break;case"FollowFan":A=blogUrl+"/phoenix/web/v1/fans/list"}}function r(t){var e=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop,a=window.innerHeight;k&&y&&"true"===y.attr("data-flag")&&$(".content-mian-box").height()+$(".content-mian-box").offset().top<=e+a+$(".blog-footer-bottom").height()+10&&(k=!1,m(A,y))}function d(t,e){var a="",i="",o="";return e?(i=isOwner?"":t.loginUserNameIsFollow?'<span class="button active" data-flag="false" data-id="'+t.id+'">已关注</span>':'<span class="button" data-flag="true" data-id="'+t.id+'">关注</span>',a=t):t.folder&&(a=t.folder,i=t.folder.loginUserNameIsFollow?'<span class="button active" data-id="'+a.id+'" data-flag="false">已关注</span>':'<span class="button" data-id="'+a.id+'" data-flag="true">关注</span>'),o=a.favoriteNum>0?'<img class="active integration-box-img" data-flag="false" folderId="'+a.id+'" blogUsername="'+a.username+'" src="'+blogStaticHost+'dist/pc/img/DownArro.png" alt="">':"",'<div class="article-list-integration-item active"> <div class="integration-item-content"> <div class="integration-item-top"><div class="item-top"> <img src="'+blogStaticHost+'dist/pc/img/Publicfolder.png"  alt=""><h4>'+a.name+"</h4>"+o+'</div><div class="collecItem-bottom"><div class="collecItem-item"><span>'+a.favoriteNum+'条内容</span><span class="cloecFloww">'+a.followNum+"</span>人关注</div></div></div>"+i+'</div><div class="Favorite-bottom-box"></div></div>'}function p(t,e){var a="",i="";return t.companyExpert||t.expert?t.companyExpert&&t.expert?a='<img src="'+blogStaticHost+'dist/mobile/img/enterpriseNew.png" alt=""><img src="'+blogStaticHost+'dist/mobile/img/expertNew.png" alt="">':t.companyExpert?a='<img src="'+blogStaticHost+'dist/mobile/img/enterpriseNew.png" alt="">':t.expert&&(a='<img src="'+blogStaticHost+'dist/mobile/img/expertNew.png" alt="">'):a="",i=t.loginUserNameIsFollow?'<p class="button active" data-flag="false" data-username="'+t.username+'">已关注</p>':'<p class="button" data-flag="true" data-username="'+t.username+'">关注</p>','<div class="blogFollow-item"><div class="blogFollow-left"><a data-report-click=\'{"spm":"1001.2014.3001.5234"}\' href="'+t.blogUrl+'" target="_blank"><img src="'+t.userAvatar+'" alt=""></a><dl><dd> <a data-report-click=\'{"spm":"1001.2014.3001.5234"}\' href="'+t.blogUrl+'" target="_blank"> <h4>'+t.nickname+"</h4></a>"+a+' </dd><dt><span class="active">码龄'+t.years+"年</span> </dt></dl></div>"+i+"</div>"}function m(t,e,a){var i="",o=e.attr("data-page"),n='<div class="no-data d-flex flex-column justify-content-center align-items-center"><p><img class="monkey-blank" src="https://csdnimg.cn/release/blogv2/dist/pc/img/monkeyBlack.png"> </p><h6>空空如也</h6><p class="remark"></p><p></div>';e.append('<div class="article-login">正在加载...</div>'),C=$.ajax({url:t,type:"GET",dataType:"json",xhrFields:{withCredentials:!0},async:!1,data:{page:o,pageSize:40,blogUsername:username},success:function(t){if(200===t.code){switch(T){case"collecAdd":$('.collecItem-type span[data-type="collecAdd"]').text("TA创建的收藏夹（ "+t.data.total+" ）");break;case"collecFan":$('.collecItem-type span[data-type="collecFan"]').text("TA关注的收藏夹（ "+t.data.total+" ）");break;case"FollowNum":$('.blogFollow-type span[data-type="FollowNum"]').text("TA关注的人（ "+t.data.total+" ）");break;case"FollowFan":$('.blogFollow-type span[data-type="FollowFan"]').text("TA的粉丝（ "+t.data.total+" ）")}if(e.find(".article-login")[0]&&e.find(".article-login").remove(),t.data.list&&t.data.list.length>0){for(var a=0;a<t.data.list.length;a++)"collecAdd"===T?i+=d(t.data.list[a],!0):"collecFan"===T?i+=d(t.data.list[a]):"FollowNum"===T?i+=p(t.data.list[a]):"FollowFan"===T&&(i+=p(t.data.list[a]));e.append(i),f(T),h(T)}else"1"===e.attr("data-page")?(e.append(n),e.attr("data-flag","false")):(e.attr("data-flag","false"),e.append('<div class="article-login">- 到底了 -</div>'));e.attr("data-page",1*o+1+"")}else e.find(".article-login")[0]&&e.find(".article-login").remove(),0==e.children().length&&e.append(n);k=!0},error:function(t){e.find(".article-login")[0]&&e.find(".article-login").remove(),0==e.children().length&&e.append(n)}})}function u(t){var e="";$(".blogFollow-box .button").unbind("click").removeAttr("onclick").click(function(t){e="true"==$(this).attr("data-flag")?"https://me.csdn.net/api/relation/create?source=blog":"https://me.csdn.net/api/relation/destroy?source=blog",g(e,{username:$(this).attr("data-username")},this)})}function g(t,e,a,i){getCookie("UserName")?$.ajax({type:"post",url:t,dataType:"json",contentType:"application/json; charset=utf-8",xhrFields:{withCredentials:!0},data:JSON.stringify(e),success:function(t){if("true"==$(a).attr("data-flag")){if($(a).attr("data-flag",!1),$(a).text("已关注"),$(a).addClass("active"),"collecAdd"==i||"collecFan"==i){var e=$(a).siblings(".integration-item-top").find(".cloecFloww");e.html(1*e.text()+1)}}else if($(a).attr("data-flag",!0),$(a).text("关注"),$(a).removeClass("active"),"collecAdd"==i||"collecFan"==i){var e=$(a).siblings(".integration-item-top").find(".cloecFloww");e.html(1*e.text()-1)}}}):window.csdn.loginBox.show()}function f(t){var e="https://me.csdn.net/api/favorite/followFolder";$(".integration-item-content .button").unbind("click").removeAttr("onclick").click(function(a){var i=this;e="true"==$(this).attr("data-flag")?"https://me.csdn.net/api/favorite/followFolder":"https://me.csdn.net/api/favorite/unFollowFolder",g(e,{id:1*$(i).attr("data-id"),source:"blog"},this,t)})}function h(t){switch(t){case"collecAdd":v();break;case"collecFan":v();break;default:return void u()}}function v(){$(".article-list-integration-item .integration-box-img").unbind("click").removeAttr("onclick").click(function(t){var e=$(this).parents(".integration-item-content").siblings(".Favorite-bottom-box");if("true"==$(this).attr("data-flag"))e.removeClass("active"),$(this).attr("data-flag","false"),$(this).attr("src",blogStaticHost+"dist/pc/img/DownArro.png");else{e.addClass("active"),$(this).attr("data-flag","true"),$(this).attr("src",blogStaticHost+"dist/pc/img/upArrow.png");var a=this;"true"!=$(a).attr("data-demo")&&$.ajax({url:blogUrl+"/phoenix/web/v1/collect-folder/item-list",type:"GET",dataType:"json",async:!1,xhrFields:{withCredentials:!0},data:{page:1,pageSize:10,folderId:$(this).attr("folderId"),blogUsername:$(this).attr("blogUsername")},success:function(t){var i="";if(200===t.code&&t.data.list){for(var o=0;o<t.data.list.length;o++){var n=t.data.list[o],l="";l=n.source?"<span>"+n.source+"</span>":"",i+='<div class="Favorite-bottom-box-item"><div class="title"> '+l+'<a data-report-click=\'{"spm":"1001.2014.3001.5235"}\' target="_blank" href="'+n.url+'"><h4>'+n.title+'</h4></></div></a><div class="content"><a data-report-click=\'{"spm":"1001.2014.3001.5235"}\' href="'+n.authorBlogUrl+'" target="_blank"><span class="name">'+n.nickname+'</span></a><span class="time">'+n.dateTime+"</span></div></div>"}e.append(i),$(a).attr("data-demo","true")}}})}})}var b=new t,w=function(){return!o()&&0!==$(".newcomer-guide").length&&(e(i()),$(window).resize(function(){e(i())}),b.disable_scroll(!0),$(".newcomer-guide").show(),void l())},x=0;s();var k=!0,y="",F="",C=null,T="",A="";$("#container-header-ul li").on("click",function(){$(this).addClass("active").siblings().removeClass("active"),$(".articleMeList-integration").eq($(this).index()).show().siblings(".articleMeList-integration").hide(),F=$(this).attr("data-type"),w(),$(this).data("flag")&&(k=!0,y=$(".rolling-load-"+$(this).data("type")).filter(".active"),T=y.data("type"),c(T),C&&C.abort(),""==y.html()&&(c(T),m(A,y,!0)))}),$(".collecItem-type span").on("click",function(){$(this).addClass("active").siblings().removeClass("active"),T=$(this).data("type"),$(".collecItem-box-add").eq($(this).index()).addClass("active").siblings(".collecItem-box-add").removeClass("active"),y=$(this).parent().siblings().filter(".active"),k=!0,c(T),y.html()||m(A,y,!0),C&&C.abort()}),$(".blogFollow-type span").on("click",function(){T=$(this).data("type"),$(this).addClass("active").siblings().removeClass("active"),$(".blogFollow-box").eq($(this).index()).addClass("active").siblings(".blogFollow-box").removeClass("active"),y=$(this).parent().siblings().filter(".active"),k=!0,c(T),C&&C.abort(),y.html()||m(A,y,!0)}),$(document).on("scroll",r)});